rule Trojan_Win32_LodaRAT_AWZA_2147946658_0
{
    meta:
        author = "defender2yara"
        detection_name = "Trojan:Win32/LodaRAT.AWZA!MTB"
        threat_id = "2147946658"
        type = "Trojan"
        platform = "Win32: Windows 32-bit platform"
        family = "LodaRAT"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_AUTOITHSTR_EXT"
        threshold = "42"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {46 00 49 00 4c 00 45 00 4f 00 50 00 45 00 4e 00 20 00 28 00 20 00 24 00 [0-50] 20 00 26 00 20 00 [0-50] 20 00 28 00}  //weight: 2, accuracy: Low
        $x_2_2 = {46 49 4c 45 4f 50 45 4e 20 28 20 24 [0-50] 20 26 20 [0-50] 20 28}  //weight: 2, accuracy: Low
        $x_2_3 = "&= CHR ( RANDOM ( 65 , 90 , 1 ) )" ascii //weight: 2
        $x_2_4 = {54 00 43 00 50 00 43 00 4f 00 4e 00 4e 00 45 00 43 00 54 00 20 00 28 00 20 00 24 00 [0-50] 20 00 5b 00 20 00 30 00 20 00 5d 00 20 00 2c 00 20 00 34 00 34 00 35 00 20 00 29 00}  //weight: 2, accuracy: Low
        $x_2_5 = {54 43 50 43 4f 4e 4e 45 43 54 20 28 20 24 [0-50] 20 5b 20 30 20 5d 20 2c 20 34 34 35 20 29}  //weight: 2, accuracy: Low
        $x_2_6 = {54 00 43 00 50 00 52 00 45 00 43 00 56 00 20 00 28 00 20 00 24 00 [0-50] 20 00 2c 00 20 00 32 00 30 00 32 00 34 00 20 00 29 00}  //weight: 2, accuracy: Low
        $x_2_7 = {54 43 50 52 45 43 56 20 28 20 24 [0-50] 20 2c 20 32 30 32 34 20 29}  //weight: 2, accuracy: Low
        $x_2_8 = {53 00 48 00 45 00 4c 00 4c 00 45 00 58 00 45 00 43 00 55 00 54 00 45 00 20 00 28 00 20 00 24 00 [0-50] 20 00 5b 00 20 00 30 00 20 00 5d 00 20 00 29 00}  //weight: 2, accuracy: Low
        $x_2_9 = {53 48 45 4c 4c 45 58 45 43 55 54 45 20 28 20 24 [0-50] 20 5b 20 30 20 5d 20 29}  //weight: 2, accuracy: Low
        $x_4_10 = "CHR ( 80 ) & CHR ( 75 ) & CHR ( 5 ) & CHR ( 6 ) & CHR ( 0 ) & CHR ( 0 ) & CHR ( 0 ) & CHR ( 0 ) &" ascii //weight: 4
        $x_4_11 = "CHR ( 0 ) & CHR ( 0 ) & CHR ( 0 ) & CHR ( 0 ) & CHR ( 0 ) & CHR ( 0 ) & CHR ( 0 ) & CHR ( 0 ) & CHR ( 0 ) &" ascii //weight: 4
        $x_4_12 = "CHR ( 0 ) & CHR ( 0 ) & CHR ( 0 ) & CHR ( 0 ) & CHR ( 0 )" ascii //weight: 4
        $x_4_13 = {42 00 49 00 54 00 41 00 4e 00 44 00 20 00 28 00 20 00 24 00 [0-50] 20 00 5b 00 20 00 30 00 20 00 5d 00 20 00 2c 00 20 00 33 00 32 00 37 00 36 00 38 00 20 00 29 00 20 00 3c 00 3e 00 20 00 30 00}  //weight: 4, accuracy: Low
        $x_4_14 = {42 49 54 41 4e 44 20 28 20 24 [0-50] 20 5b 20 30 20 5d 20 2c 20 33 32 37 36 38 20 29 20 3c 3e 20 30}  //weight: 4, accuracy: Low
        $x_4_15 = {44 00 4c 00 4c 00 43 00 41 00 4c 00 4c 00 20 00 28 00 20 00 24 00 [0-50] 20 00 2c 00 20 00 [0-50] 20 00 28 00}  //weight: 4, accuracy: Low
        $x_4_16 = {44 4c 4c 43 41 4c 4c 20 28 20 24 [0-50] 20 2c 20 [0-50] 20 28}  //weight: 4, accuracy: Low
        $x_4_17 = {42 00 49 00 54 00 4f 00 52 00 20 00 28 00 20 00 42 00 49 00 54 00 41 00 4e 00 44 00 20 00 28 00 20 00 24 00 [0-50] 20 00 2a 00 20 00 36 00 35 00 35 00 33 00 36 00 20 00 2c 00 20 00 2d 00 36 00 35 00 35 00 33 00 36 00 20 00 29 00 20 00 2c 00 20 00 42 00 49 00 54 00 41 00 4e 00 44 00 20 00 28 00 20 00 24 00 [0-50] 20 00 2c 00 20 00 36 00 35 00 35 00 33 00 35 00 20 00 29 00 20 00 29 00}  //weight: 4, accuracy: Low
        $x_4_18 = {42 49 54 4f 52 20 28 20 42 49 54 41 4e 44 20 28 20 24 [0-50] 20 2a 20 36 35 35 33 36 20 2c 20 2d 36 35 35 33 36 20 29 20 2c 20 42 49 54 41 4e 44 20 28 20 24 [0-50] 20 2c 20 36 35 35 33 35 20 29 20 29}  //weight: 4, accuracy: Low
        $x_4_19 = {53 00 54 00 52 00 49 00 4e 00 47 00 53 00 50 00 4c 00 49 00 54 00 20 00 28 00 20 00 24 00 [0-50] 20 00 2c 00 20 00 24 00 [0-50] 20 00 2c 00 20 00 31 00 20 00 29 00}  //weight: 4, accuracy: Low
        $x_4_20 = {53 54 52 49 4e 47 53 50 4c 49 54 20 28 20 24 [0-50] 20 2c 20 24 [0-50] 20 2c 20 31 20 29}  //weight: 4, accuracy: Low
        $x_4_21 = {26 00 3d 00 20 00 43 00 48 00 52 00 20 00 28 00 20 00 42 00 49 00 54 00 58 00 4f 00 52 00 20 00 28 00 20 00 24 00 [0-50] 20 00 5b 00 20 00 24 00 [0-50] 20 00 5d 00 20 00 2c 00 20 00 24 00 [0-50] 20 00 2c 00 20 00 24 00 [0-50] 20 00 2c 00 20 00 24 00 [0-50] 20 00 29 00 20 00 29 00}  //weight: 4, accuracy: Low
        $x_4_22 = {26 3d 20 43 48 52 20 28 20 42 49 54 58 4f 52 20 28 20 24 [0-50] 20 5b 20 24 [0-50] 20 5d 20 2c 20 24 [0-50] 20 2c 20 24 [0-50] 20 2c 20 24 [0-50] 20 29 20 29}  //weight: 4, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((6 of ($x_4_*) and 9 of ($x_2_*))) or
            ((7 of ($x_4_*) and 7 of ($x_2_*))) or
            ((8 of ($x_4_*) and 5 of ($x_2_*))) or
            ((9 of ($x_4_*) and 3 of ($x_2_*))) or
            ((10 of ($x_4_*) and 1 of ($x_2_*))) or
            ((11 of ($x_4_*))) or
            (all of ($x*))
        )
}

